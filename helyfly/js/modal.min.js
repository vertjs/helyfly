const d=document.querySelector("#date"),datepickerToggle=document.querySelector(".datepicker-toggle"),inputs=document.querySelectorAll(".modal input"),agree=document.querySelector(".label__after"),modal=document.querySelector(".modal"),exit=document.querySelector(".close");let p=document.createElement("p");datepickerToggle.append(p);const label=document.querySelector("label[for='agree']");function handleInputDate(e){p.textContent=function(e){function t(e){return e<10?"0"+e:e}var a=new Date(e);return[t(a.getDate()),t(a.getMonth()+1),a.getFullYear()].join(".")}(e.target.value)}function handleClose(e){modal.classList.toggle("on",!1),glass.remove()}d.addEventListener("input",handleInputDate),exit.addEventListener("click",handleClose);const form=document.querySelector(".modal form"),subm=document.querySelector(".submit");function handleAgree(e){e.target.classList.toggle("check")}subm.addEventListener("click",e=>{e.preventDefault();let t=[];Array.from(inputs).filter(e=>{e.classList.toggle("empty",!e.value),"date"===e.id&&e.parentElement.classList.toggle("empty",!e.value),!document.querySelector(".label__after").classList.contains("check")&&document.querySelector(".label__after").classList.add("red"),e.value&&t.push(e)}),t.length===inputs.length&&(modal.classList.toggle("on",!1),Array.from(inputs).forEach(e=>e.value=null),agree.classList.toggle("check",!1),document.querySelector(".datepicker-toggle p").textContent=null,glass.remove())}),agree.addEventListener("click",handleAgree),label.addEventListener("click",e=>{e.preventDefault(),agree.classList.toggle("check")});const email=document.querySelector("#email"),mobile=document.querySelector("#mobile"),card=document.querySelector("#card"),expires=document.querySelector("#expires"),cvv=document.querySelector("#cvv"),EMAIL_REGEX=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,PHONE_REGEX=/\(?([0-9]{3})\)?([ .-]?)([0-9]{3})\2([0-9]{4})/,CARD_REGEX=/(?:\d{4}[ -]?){3}(?=\d{4}\b)/gm,EXPIRES_REGEX=/^(0[1-9]|1[0-2])\D{3}([0-9]{4}|[0-9]{2})$/;function handleInput(e){let{value:t}=e.target,{id:a}=e.target;switch(a){case"email":!EMAIL_REGEX.test(t)&&l(e);break;case"mobile":!PHONE_REGEX.test(t)&&l(e);break;case"expires":!EXPIRES_REGEX.test(t)&&l(e);break;case"cvv":!CVV_REGEX.test(t)&&l(e);break;case"card":!CARD_REGEX.test(t)&&l(e)}function l(e){e.preventDefault(),e.target.setCustomValidity("Поле заполнено неверно"),e.target.reportValidity()}}function addEncrypt(e){let{value:t}=e.target;e.target.value=t.replace(/[0-9]/gi,"*")}function addSlash(e){let{value:t}=e.target;2===t.length&&(e.target.value+=" / ")}email.addEventListener("change",handleInput),mobile.addEventListener("change",handleInput),card.addEventListener("change",handleInput),expires.addEventListener("change",handleInput),cvv.addEventListener("input",addEncrypt),expires.addEventListener("input",addSlash);